# 压力采集数据分析系统

## 🚀 项目概述

这是一个现代化的压力采集数据分析系统，采用 **FastAPI + Vue.js + R** 的混合架构，提供专业的数据分析和可视化功能。

## 🏗️ 系统架构

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   Vue.js前端    │    │   FastAPI后端    │    │   R分析引擎     │
│                 │    │                  │    │                 │
│ • 现代化界面    │◄──►│ • RESTful API    │◄──►│ • 专业分析算法  │
│ • 实时交互      │    │ • rpy2接口       │    │ • 29个图表      │
│ • 响应式设计    │    │ • 文件处理       │    │ • 统计报告      │
│ • 图表展示      │    │ • 异步处理       │    │ • 数据清洗      │
└─────────────────┘    └──────────────────┘    └─────────────────┘
```

## 📦 技术栈

### 后端
- **FastAPI** - 现代化Python Web框架
- **rpy2** - Python调用R语言接口
- **pandas** - 数据处理
- **uvicorn** - ASGI服务器

### 前端
- **Vue.js 3** - 渐进式JavaScript框架
- **Element Plus** - 现代化UI组件库
- **Axios** - HTTP客户端
- **ECharts** - 数据可视化

### 分析引擎
- **R 4.0+** - 统计分析
- **tidyverse** - 数据处理生态
- **ggplot2** - 数据可视化
- **plotly** - 交互式图表

## 🛠️ 安装和运行

### 1. 环境准备

```bash
# 克隆项目
git clone <repository-url>
cd pressure-analysis-system

# 安装R环境 (macOS)
brew install r

# 安装Python依赖
pip install -r backend/requirements.txt

# 安装前端依赖
cd frontend
npm install
```

### 2. 配置R环境

```bash
# 进入R环境安装必要包
R
```

```r
# 在R控制台中执行
install.packages(c("tidyverse", "ggplot2", "plotly", "ggthemr", "showtext", "readr", "dplyr", "lubridate"))
quit()
```

### 3. 启动开发环境

```bash
# 启动后端API (在项目根目录)
cd backend
uvicorn main:app --reload --host 0.0.0.0 --port 8000

# 启动前端开发服务器 (新终端窗口)
cd frontend
npm run dev
```

### 4. 访问应用

- 前端界面：http://localhost:3000
- API文档：http://localhost:8000/docs
- API接口：http://localhost:8000

## 📋 功能特性

### 核心功能
- ✅ **CSV数据上传与解析**
- ✅ **参数配置界面**
- ✅ **29个专业分析图表**
- ✅ **统计分析报告**
- ✅ **数据清洗与验证**
- ✅ **结果导出 (PDF/CSV/图片)**

### 分析功能
- 📊 **基础统计分析** - 均值、标准差、成功率等
- 📈 **趋势分析** - 时间序列、漂移检测
- 🎯 **精度分析** - 目标偏差、容差检验
- 🔍 **异常检测** - 离群值识别
- 📉 **控制图分析** - SPC质量控制
- 🗺️ **空间分析** - 位置相关性分析

### 界面特性
- 🎨 **现代化设计** - 清爽简洁的用户界面
- 📱 **响应式布局** - 支持多种屏幕尺寸
- ⚡ **实时反馈** - 上传和分析进度提示
- 🎛️ **参数配置** - 直观的配置界面
- 📊 **交互式图表** - 可缩放、悬停查看详情

## 📁 项目结构

```
pressure-analysis-system/
├── backend/                 # FastAPI后端
│   ├── main.py             # 主应用入口
│   ├── api/                # API路由
│   ├── core/               # 核心配置
│   ├── services/           # 业务逻辑
│   └── requirements.txt    # Python依赖
├── frontend/               # Vue.js前端
│   ├── src/                # 源代码
│   ├── public/             # 静态资源
│   ├── package.json        # Node.js依赖
│   └── vite.config.js      # 构建配置
├── r_analysis/             # R分析脚本
│   └── pressure_analysis.R # 核心分析算法
├── uploads/                # 上传文件存储
├── static/                 # 静态文件
├── docs/                   # 文档
└── docker-compose.yml      # Docker编排
```

## 🐋 Docker部署

```bash
# 构建并启动容器
docker-compose up --build

# 后台运行
docker-compose up -d
```

## 📖 API文档

启动后端服务后，访问 http://localhost:8000/docs 查看完整的API文档。

主要端点：
- `POST /api/analyze` - 上传数据并执行分析
- `GET /api/results/{task_id}` - 获取分析结果
- `GET /api/download/{file_type}/{task_id}` - 下载结果文件

## 🧪 测试

```bash
# 后端测试
cd backend
pytest

# 前端测试
cd frontend
npm run test
```

## 📝 使用说明

1. **上传数据**：选择包含 `序号,X,Y,Z,力值` 列的CSV文件
2. **配置参数**：设置目标力值、容差范围等分析参数
3. **执行分析**：点击分析按钮，系统将自动处理数据
4. **查看结果**：浏览29个专业图表和统计报告
5. **导出结果**：下载PDF报告、清洗后的数据或图表包

## 🤝 贡献指南

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## 📞 联系方式

如有问题或建议，请提交 Issue 或联系开发团队。

---

**专业 | 现代化 | 易用性**

## 📊 项目概述

**压力采集数据可靠性与状态分析仪** 是一个专业的工业质量控制分析工具，专门用于分析压力传感器采集的CSV数据。系统采用现代化的R语言和tidyverse生态系统，提供全面的统计过程控制(SPC)、质量管理和数据可视化功能。

### 🎯 核心目标
- 自动化分析压力采集装置生成的CSV数据
- 评估系统的可靠性、准确性和稳定性
- 识别潜在问题和性能退化趋势
- 通过专业图表和报告直观展示分析结果
- 支持工业4.0和六西格玛质量管理体系

## ✨ 主要特性

### 🔧 数据处理能力
- ✅ **CSV文件自动解析**: 支持标准格式 `序号,X,Y,Z,力值`
- ✅ **数据质量检查**: 自动检测缺失值、重复行、异常值
- ✅ **智能数据清理**: 自动处理单位标识，数据类型转换
- ✅ **多目标力值分析**: 自动识别和分组分析不同目标力值

### 📈 统计分析功能

#### 基础统计分析 ✅
- 均值、中位数、标准差、最大/最小值、极差
- 变异系数、偏度、峰度分析
- 分位数分析(Q25, Q75)
- 按目标力值分组统计

#### 性能与精度分析 ✅
- 绝对偏差和百分比偏差计算
- 容差内成功率统计(绝对容差 + 百分比容差)
- 系统偏差(Bias)分析
- 测量系统能力评估

#### 趋势分析 ✅
- 线性回归趋势检测
- 移动平均分析(可配置窗口大小)
- 趋势显著性检验(p值)
- 漂移检测和量化

#### 高级时间序列分析 ✅
- **异常值检测**: IQR方法 + Z-score方法
- **稳定性分析**: 游程检验(Run Test)
- **变化点检测**: 滑动窗口方法
- **自相关分析**: 多滞后期相关性
- **综合质量评估**: 多维度质量指标

#### 过程能力分析 ✅
- **Cp指数**: 过程能力指数
- **Cpk指数**: 过程能力指数(考虑偏移)
- **能力等级评估**: 自动分级(优秀/良好/合格/不合格)
- **规格限制分析**: USL/LSL计算

### 📊 可视化系统 (29个专业图表)

#### 🎯 基础分析图形 (1-5)
1. **力值时间序列图** - 趋势观察，容差范围标识
2. **力值分布直方图** - 数据分布特征分析  
3. **力值箱线图** - 快速异常值识别
4. **绝对偏差箱线图** - 与目标值的绝对偏差
5. **百分比偏差箱线图** - 相对偏差分析

#### 🎯 统计过程控制图 (6-8, 23, 26-29)
6. **Shewhart控制图** - 传统3σ控制，检测大偏移
7. **移动平均图** - 趋势平滑，置信区间
8. **X-bar & R控制图** - 均值和变异性监控
23. **CUSUM累计和控制图** - 小幅持续偏移检测
26. **控制图组合面板** - X-bar和R图完整组合
27. **EWMA指数加权移动平均控制图** - 对小偏移敏感
28. **I-MR个值移动极差控制图** - 个别测量值控制
29. **过程能力分析直方图** - 分布vs规格限制

#### 🎯 多维空间分析图 (9-13)
9. **3D交互式散点图** - 空间分布和异常检测
10. **XY平面热力图** - 密度分布分析
11. **并行坐标图** - 多维异常模式识别
12. **2D投影图组合** - XY、XZ、YZ三投影面
13. **空间聚类异常检测图** - 聚类分析异常识别

#### 🎯 质量管理图形 (14-16, 18-22)
14. **成功率趋势分析** - 时间批次质量表现
15. **过程能力图表** - Cp、Cpk可视化
16. **质量仪表盘** - 关键指标快速监控
18. **帕雷托图** - 异常原因80/20分析
19. **残差分析图** - 模型假设检验
20. **QQ图** - 正态性检验
21. **运行图** - 非随机模式检测
22. **雷达图** - 多指标综合评估

#### 🎯 专业分析图形 (17, 24-25)
17. **相关性分析矩阵** - 变量间关系分析
24. **位置异常率热力图** - 空间质量分布
25. **质量损失瀑布图** - 累积损失分析

### 📋 报告系统 ✅
- **综合分析报告**: 自动生成文本摘要
- **趋势分析报告**: 显著性检验结果
- **异常值分析报告**: 多方法检测结果
- **稳定性分析报告**: 游程检验统计
- **目标力值分析报告**: 分组详细统计
- **建议系统**: 基于分析结果的智能建议

## 🚀 快速开始

### 环境要求
- R 4.0+ 
- 必需包: `tidyverse`, `readr`, `ggplot2`, `dplyr`, `slider`, `broom`, `GGally`, `ggthemr`, `showtext`, `plotly`

### 安装依赖
```r
# 脚本会自动检查并安装缺失的包
required_packages <- c("tidyverse", "readr", "ggplot2", "dplyr", "slider", "broom", "GGally", "ggthemr", "showtext", "plotly")
new_packages <- required_packages[!(required_packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)
```

### 使用方法

#### 1. 准备数据文件
确保CSV文件格式为:
```csv
序号,X,Y,Z,力值
1,97.2,96.4,111,3.6N
2,98.8,101.3,106.6,23.5N
3,107.8,98.8,98.7,48.1N
...
```

#### 2. 配置分析参数
```r
# 在脚本中修改以下参数
target_forces <- c(5, 25, 50)  # 目标力值列表
tolerance_abs <- 2             # 绝对容差 (N)
tolerance_pct <- 5             # 百分比容差 (%)
window_size <- 10              # 移动窗口大小
data_file <- "your_data.csv"   # 数据文件路径
```

#### 3. 运行分析
```bash
# 命令行运行
Rscript pressure_analysis_simple.R

# 或在R环境中
source("pressure_analysis_simple.R")
```

#### 4. 查看结果
- **图表**: 自动显示29个专业分析图表
- **数据文件**: `cleaned_pressure_data.csv` (清理后数据)
- **分析结果**: `analysis_results.RData` (R数据对象)
- **控制台报告**: 详细的文本分析报告

## 📊 功能覆盖对比

### ✅ 已完全实现的必需功能

| 功能模块 | 子功能 | 实现状态 | 备注 |
|---------|--------|----------|------|
| **数据接口** | CSV文件加载解析 | ✅ 完成 | 支持标准格式，自动类型转换 |
| | 数据格式校验 | ✅ 完成 | 全面的质量检查和错误处理 |
| **配置模块** | 目标力值配置 | ✅ 完成 | 支持多目标力值 |
| | 容差范围定义 | ✅ 完成 | 绝对容差+百分比容差 |
| | 趋势分析参数 | ✅ 完成 | 可配置移动窗口大小 |
| **基础统计** | 描述性统计 | ✅ 完成 | 全面的统计指标 |
| | 测量次数统计 | ✅ 完成 | 按组统计 |
| **性能分析** | 偏差计算 | ✅ 完成 | 绝对+百分比偏差 |
| | 成功率计算 | ✅ 完成 | 双重容差标准 |
| | 系统偏差分析 | ✅ 完成 | Bias计算 |
| **趋势分析** | 漂移分析 | ✅ 完成 | 线性回归+移动平均 |
| **可视化** | 时间序列图 | ✅ 完成 | 含容差带和趋势线 |
| | 偏差图 | ✅ 完成 | 绝对+百分比偏差 |
| | 分布直方图 | ✅ 完成 | 按目标力值分组 |
| | 图表导出 | ✅ 完成 | 自动保存功能 |
| **报告系统** | 文本摘要报告 | ✅ 完成 | 详细的分析报告 |

### ✅ 已实现的可选高级功能

| 功能模块 | 子功能 | 实现状态 | 备注 |
|---------|--------|----------|------|
| **高级分析** | 异常值检测 | ✅ 完成 | IQR + Z-score双重检测 |
| | 变异性趋势 | ✅ 完成 | 标准差随时间变化 |
| | 成功率趋势 | ✅ 完成 | 时间序列成功率 |
| | 位置一致性分析 | ✅ 完成 | 空间分布分析 |
| **SPC控制图** | X-bar & R图 | ✅ 完成 | 完整的SPC控制图系统 |
| | CUSUM图 | ✅ 完成 | 小偏移检测 |
| | EWMA图 | ✅ 完成 | 指数加权移动平均 |
| | I-MR图 | ✅ 完成 | 个值移动极差控制 |
| **高级可视化** | 箱线图 | ✅ 完成 | 多维度对比 |
| | 热力图 | ✅ 完成 | 空间分布可视化 |
| | 3D交互图 | ✅ 完成 | Plotly交互式图表 |
| | 控制图系列 | ✅ 完成 | 完整的SPC图表集 |
| **过程能力** | Cp/Cpk分析 | ✅ 完成 | 过程能力评估 |

## 🔧 技术特点

### 现代化R编程
- **tidyverse生态**: 使用dplyr、ggplot2、purrr等现代R包
- **函数式编程**: 大量使用map、filter、mutate等函数式操作
- **类型安全**: 严格的数据类型检查和转换
- **管道操作**: 使用%>%提高代码可读性

### 专业可视化
- **ggthemr主题**: 统一的专业图表风格
- **中文字体支持**: 自动配置中文字体显示
- **交互式图表**: Plotly支持的3D和交互功能
- **自适应布局**: 图表自动适应数据特征

### 工业标准符合
- **SPC控制图**: 符合ISO 9001质量管理体系
- **六西格玛方法**: 支持DMAIC改进流程
- **统计检验**: 严格的统计显著性检验
- **过程能力**: 工业标准的Cp/Cpk计算

## 📈 分析层次结构

### 第一层：基础分析 (图表1-5)
**目的**: 快速了解数据基本特征
- 数据分布是否正常
- 是否存在明显异常值
- 基本统计特征

### 第二层：过程控制 (图表6-8, 26-29)
**目的**: 监控过程稳定性
- 过程是否受控
- 是否存在特殊原因变异
- 过程能力是否满足要求

### 第三层：深度分析 (图表9-25)
**目的**: 深入挖掘问题根因
- 空间分布特征
- 多维关联分析
- 质量损失评估

## 💡 使用建议

### 分析流程建议
1. **首先查看基础图表(1-5)**: 了解数据整体情况
2. **检查控制图(6-8)**: 判断过程是否稳定
3. **深入专项分析**: 根据发现的问题选择相应图表
4. **综合评估**: 结合多个维度得出结论

### 参数调整指导
- **容差设置**: 根据实际工艺要求设定
- **移动窗口**: 数据量大时可增大窗口提高稳定性
- **目标力值**: 根据实际测试点设定

### 结果判断标准
- **成功率 > 95%**: 优秀
- **成功率 90-95%**: 良好  
- **成功率 80-90%**: 合格
- **成功率 < 80%**: 需要改进

## 🔍 常见问题

### Q: 如何处理数据文件编码问题？
A: 脚本自动尝试UTF-8和GBK编码，如仍有问题请转换为UTF-8编码。

### Q: 图表显示中文乱码怎么办？
A: 脚本会自动配置中文字体，如仍有问题请检查系统字体安装。

### Q: 如何自定义分析参数？
A: 修改脚本开头的参数配置部分，包括目标力值、容差等。

### Q: 可以分析其他格式的数据吗？
A: 目前仅支持CSV格式，其他格式需要先转换为标准CSV格式。

## 📝 更新日志

### v1.0.0 (当前版本)
- ✅ 完整的29图表分析系统
- ✅ 全面的统计分析功能
- ✅ 现代化R编程实现
- ✅ 专业的SPC控制图系统
- ✅ 智能的异常检测和报告

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目。

---

**开发团队**: 压力系统分析团队  
**技术支持**: 基于R语言和tidyverse生态系统  
**更新时间**: 2024年12月 